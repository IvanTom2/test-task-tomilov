# Test Task 1

## Описание

Асинхронный FastAPI сервис для получения версии базы данных PostgreSQL через пул подключений `asyncpg`.

## Запуск

1. **Клонируйте репозиторий и перейдите в папку проекта:**

    ```bash
    git clone <repo>
    cd test-task-tomilov/1
    ```

2. **Создайте файл `.env` на основе примера `.env.example` и заполните необходимые переменные окружения:**

    ```bash
    cp .env.example .env
    # Отредактируйте .env - заполните его данными подключения к PostgreSQL
    ```

3. **Установите зависимости:**

    ```bash
    uv sync
    ```

    #### Или через Python
    ```bash
    python3 -m venv .venv
    python3 -m pip install .
    ```

4. **Запустите проект:**

    ```bash
    uv run uvicorn main:create_app --factory
    ```

    #### Или через обычный Python
    ```bash
    source .venv/bin/activate
    python3 -m uvicorn main:create_app --factory
    ```

## Эндпоинты

- `GET /api/db_version` - получить версию PostgreSQL.

## Примечания
- Важно! Эндпоинт документации не отключен. В будущем необходимо устранить потенциальную уязвимость. 
- В настройках можно выставить флаг наличия PgBouncer. Это необходимо, чтобы отключить Prepared Statements на стороне asyncpg и не попадать на ошибки сессий. 
- Логика взаимодействия с базой данных определена прямо в эндпоинте. С точки зрения проектирования это является ошибкой. Не было исправлено в силу тестового задания. 


## Особенности
- Для работы необходим файл `.env` с настройками подключения к базе данных.
- Используется FastAPI, asyncpg, pydantic, pydantic_settings. 
